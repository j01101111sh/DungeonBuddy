{% load static %}

<div class="card shadow-sm mb-4">
    <div class="card-header">
        <h5 class="mb-0">Helpful Links</h5>
    </div>
    <div class="card-body">
        <ul id="helpful-links-list" class="list-group list-group-flush">
            {% for link in campaign.helpful_links.all %}
                <li id="link-{{ link.pk }}"
                    class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="{{ link.url }}" target="_blank">{{ link.name }}</a>
                    {% if request.user == campaign.dungeon_master %}
                        <button class="btn btn-sm btn-outline-danger delete-link-btn"
                                data-link-pk="{{ link.pk }}">
                            <i class="fas fa-trash"></i>
                        </button>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
        {% if not campaign.helpful_links.all %}
            <p id="no-links-message" class="text-muted">No helpful links yet.</p>
        {% endif %}
        {% if request.user == campaign.dungeon_master and campaign.helpful_links.count < 20 %}
            <hr />
            <h6>Add a New Link</h6>
            <form id="add-link-form"
                  method="post"
                  action="{% url 'helpful_link_add' pk=campaign.pk %}">
                {% csrf_token %}
                <div id="add-link-errors" class="alert alert-danger hidden"></div>
                <div class="mb-3">
                    <label for="id_name" class="form-label">Name</label>
                    <input type="text" name="name" id="id_name" class="form-control" required />
                </div>
                <div class="mb-3">
                    <label for="id_url" class="form-label">URL</label>
                    <input type="text" name="url" id="id_url" class="form-control" required />
                </div>
                <button type="submit" class="btn btn-primary">Add Link</button>
            </form>
        {% endif %}
    </div>
</div>
<script src="{% static 'js/helpful_links.js' %}"></script>
