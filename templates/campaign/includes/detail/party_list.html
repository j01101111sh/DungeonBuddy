<div class="card border-0 shadow-sm mb-4 rounded-4">
    <div class="card-header bg-transparent border-bottom-0 pt-4 px-4 pb-2">
        <div class="d-flex justify-content-between align-items-end">
            <h5 class="card-title fw-bold mb-0">Party Members</h5>
            <span class="badge bg-secondary-subtle text-secondary border border-secondary-subtle rounded-pill">{{ campaign.players.count }} / {{ campaign.max_players }}</span>
        </div>
    </div>
    <div class="card-body p-2">
        <div class="list-group list-group-flush">
            {% for player in players_with_data %}
                <div class="list-group-item border-0 px-3 py-2 rounded-3 mb-1 d-flex align-items-center justify-content-between player-card-row">
                    <div class="d-flex align-items-center gap-3">
                        <div class="campaign-avatar-initial bg-primary-subtle text-primary">{{ player.username|slice:":1"|upper }}</div>
                        <div class="min-width-0">
                            <div class="fw-bold text-truncate">
                                <a href="{{ player.get_absolute_url }}">{{ player.username }}</a>
                            </div>
                            {% if player.campaign_character %}
                                <div class="small text-muted text-truncate">{{ player.campaign_character.name }}</div>
                            {% else %}
                                <div class="small text-muted fst-italic">No Character</div>
                            {% endif %}
                        </div>
                    </div>
                    {% if player.campaign_character %}
                        <div class="d-flex gap-1">
                            <a href="{% url 'character_detail' player.campaign_character.pk %}"
                               class="btn btn-sm btn-icon btn-light text-secondary"
                               title="View Profile">ðŸ‘¤</a>
                            {% if player.campaign_character.character_sheet_link %}
                                <a href="{{ player.campaign_character.character_sheet_link }}"
                                   target="_blank"
                                   rel="noopener noreferrer"
                                   class="btn btn-sm btn-icon btn-light text-secondary"
                                   title="Character Sheet">ðŸ“œ</a>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
            {% empty %}
                <div class="text-center py-4 text-muted small">The party is gathering...</div>
            {% endfor %}
        </div>
    </div>
</div>
